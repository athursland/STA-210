---
title: "Final Project"
author: "Ali Thursland and Mary Helen Wood"
date: "11/20/2018"
output: html_document
---

```{r setup, warning=FALSE, echo=FALSE, message=FALSE}
#Setup
library("dplyr")
library("ggplot2")
library("broom")
library("knitr")
library("cowplot")
library("readr")
library("dslabs")
```

```{r data}
#Read file
airbnb <- read.csv("https://raw.githubusercontent.com/athursland/STA-210/master/airbnb.csv?fbclid=IwAR0ffZSvoMPWxJjX-a4gWp2UlripEqAK0NJtu2ioHgmG0uWjCm20Hse8pNw")
```

# Data Preparation

```{r manipulating-data}
#Make new variable has_reviews
airbnb <- airbnb %>% 
  mutate(has_reviews = case_when( 
    number_of_reviews == 0 ~ 0, 
    number_of_reviews > 0 ~ 1)
  )

#Make NAs = 0 for security_deposit
airbnb <- airbnb %>% 
  mutate(security_deposit = if_else(is.na(security_deposit),0,security_deposit))

#Make NAs = 0 for cleaning_fee
airbnb <- airbnb %>% 
  mutate(cleaning_fee = if_else(is.na(cleaning_fee),0,cleaning_fee))

#Make NAs = 0 for review_scores_rating
airbnb <- airbnb %>% 
  mutate(review_scores_rating = case_when(
    is.na(review_scores_rating) ~ 0, 
    !is.na(review_scores_rating) ~ review_scores_rating)
    )

#Make NAs = 0 for review_scores_accuracy
airbnb <- airbnb %>% 
  mutate(review_scores_accuracy = case_when(
    is.na(review_scores_accuracy) ~ 0, 
    !is.na(review_scores_accuracy) ~ review_scores_accuracy)
    )

#Make NAs = 0 for review_scores_cleanliness
airbnb <- airbnb %>% 
  mutate(review_scores_cleanliness = case_when( 
    is.na(review_scores_cleanliness) ~ 0, 
    !is.na(review_scores_cleanliness) ~ review_scores_cleanliness)
    )

#Make NAs = 0 for review_scores_checkin
airbnb <- airbnb %>% 
  mutate(review_scores_checkin = case_when( 
    is.na(review_scores_checkin) ~ 0, 
    !is.na(review_scores_checkin) ~ review_scores_checkin)
    )

#Make NAs = 0 for review_scores_communcation
airbnb <- airbnb %>% 
  mutate(review_scores_communication = case_when( 
    is.na(review_scores_communication) ~ 0, 
    !is.na(review_scores_communication) ~ review_scores_communication)
    )

#Make NAs = 0 for review_sores_location 
airbnb <- airbnb %>% 
  mutate(review_scores_location = case_when( 
    is.na(review_scores_location) ~ 0, 
    !is.na(review_scores_location) ~ review_scores_location)
    )

#Make NAs = 0 for review_scores_value
airbnb <- airbnb %>% 
  mutate(review_scores_value = case_when( 
    is.na(review_scores_value) ~ 0, 
    !is.na(review_scores_value) ~ review_scores_value)
    )

#Make NAs = 0 for reviews_per_month
airbnb <- airbnb %>% 
  mutate(reviews_per_month = case_when( 
    is.na(reviews_per_month) ~ 0, 
    !is.na(reviews_per_month) ~ reviews_per_month)
    )
```

```{r omit-na}
#Omit all observations with NAs 
airbnb <- airbnb[complete.cases(airbnb),]
```

Question of interest: How can we produce a model that accurately predicts the listed nightly price for an Airbnb in Asheville, NC?

Variables: 
* host_response_rate
* host_is_superhost
* total listings
* zip code
* property_type
* room_type
* accomodates
* bathrooms
* beds
* bed_type
* price
* security deposit
* cleaning fee
* guests included 
* extra people cost
* minimum nights
* maximum nights
* availability_30
* number_of_reviews
* review_scores_rating
* review_scores_accuracy
* review_scores_cleanliness
* review_scores_checkin
* review_scores_communication
* review_scores_location
* review_scores_value
* reviews_per_month
* cancellation_policy

# Exploratory Data Analysis

```{r pairs-plots}
#pairs plots for all of the explanatory variables
pairs(price ~ host_response_rate + host_is_superhost + host_listings_count, data=airbnb)
pairs(price ~ zipcode + room_type + bathrooms, data=airbnb)
pairs(price ~ accommodates + beds + bed_type, data=airbnb)
pairs(price ~ security_deposit + cleaning_fee + guests_included, data = airbnb)
pairs(price ~ extra_people + minimum_nights + availability_30, data = airbnb)
pairs(price ~ number_of_reviews + review_scores_rating + review_scores_accuracy, data = airbnb)
pairs(price ~ review_scores_cleanliness + review_scores_checkin + review_scores_communication, data = airbnb)
pairs(price ~ review_scores_location + review_scores_value + reviews_per_month, data = airbnb)
pairs(price ~ cancellation_policy, data = airbnb)
```

```{r}
airbnb <- airbnb %>% mutate(log.bathrooms = log(bathrooms),
                            log.cleaningfee = log(cleaning_fee))
```

```{r}
pairs(price ~ log.bathrooms + log.cleaningfee, data = airbnb)
```



